<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Input Surat - Sekretariat BEM</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  </head>
  <body>
    <header class="navbar">
      <div class="logo">
        <img src="aset/logoBemFooter.png" alt="Logo BEM" />
        <h2>Sekretariat BEM</h2>
      </div>
      <button class="nav-toggle" onclick="toggleMenu()">â˜°</button>
      <nav id="navMenu">
        <a href="index.html">Beranda</a>
        <a href="absensi.html">Absensi</a>
        <a href="input-surat.html" class="active">Input Surat</a>
        <a href="rekap.html">Rekap</a>
        <a href="anggota.html">Anggota</a>
        <a href="kontak.html">Kontak</a>
        <a href="#" class="logout-link" onclick="logout()">
          <i class="bi bi-box-arrow-right"></i> Logout
        </a>
      </nav>
    </header>

    <main class="container">
      <!-- Modal Notifikasi Besar -->
      <div id="popupNotif" class="popup-notif" style="display: none">
        <div class="popup-content">
          <h3>Data berhasil diinput!</h3>
          <p>Lanjutkan ke halaman rekap?</p>
          <div class="popup-buttons">
            <button class="yes" onclick="window.location.href='rekap.html'">Yes</button>
            <button class="no" onclick="closePopup()">No</button>
          </div>
        </div>
      </div>

      <h2>Form Input Surat</h2>
      <form id="formSurat" class="form-box">
        <div class="form-row">
          <div class="form-group">
            <input type="text" id="nomor" name="nomor" placeholder="Nomor" required />
          </div>
          <div class="form-group">
            <input type="date" id="tanggal" name="tanggal" required />
          </div>
        </div>

        <input type="text" id="jenis" name="jenis" placeholder="Jenis Surat" required />
        <input type="text" id="perihal" name="perihal" placeholder="Perihal" required />

        <!-- Tombol Upload -->
        <a href="https://docs.google.com/forms/d/18MhDtcs1UGo7ViWl9K6vSHWSi6Bacr5_vPI-eJXlUJc/viewform"
           target="_blank"
           rel="noopener noreferrer"
           class="btn-upload"
           style="display: none;">
           ðŸ“¤ Upload Surat
        </a>

        <button class="btn btn-simpan">Simpan</button>
      </form>
    </main>

    <!-- Modal Konfirmasi Logout -->
    <div id="logoutModal" class="modal" style="display: none;">
      <div class="modal-content">
        <p>Yakin ingin logout?</p>
        <div class="modal-actions">
          <button class="btn-cancel" onclick="closeLogoutModal()">Batal</button>
          <button class="btn-confirm" onclick="confirmLogout()">Logout</button>
        </div>
      </div>
    </div>

    <script>
      // Terapkan dark mode jika ada
      document.addEventListener("DOMContentLoaded", function () {
        const isDark = localStorage.getItem("darkMode") === "true";
        document.body.classList.toggle("dark-mode", isDark);
      });

      // Form surat simpan
      document.getElementById("formSurat").addEventListener("submit", function (e) {
        e.preventDefault();
        const nomor = document.getElementById("nomor").value;
        const tanggal = document.getElementById("tanggal").value;
        const jenis = document.getElementById("jenis").value;
        const perihal = document.getElementById("perihal").value;

        const suratBaru = { nomor, tanggal, jenis, perihal };
        const dataLama = JSON.parse(localStorage.getItem("suratMasuk")) || [];
        dataLama.push(suratBaru);
        localStorage.setItem("suratMasuk", JSON.stringify(dataLama));

        document.getElementById("popupNotif").style.display = "flex";
      });

      function closePopup() {
        document.getElementById("popupNotif").style.display = "none";
        document.getElementById("formSurat").reset();
      }

      function toggleMenu() {
        const nav = document.getElementById("navMenu");
        nav.classList.toggle("show");
      }

      // Tombol Upload otomatis muncul untuk jenis 'keluar'
      document.addEventListener("DOMContentLoaded", function () {
        const selectJenis = document.getElementById("jenis");
        const btnUpload = document.querySelector(".btn-upload");

        function updateTombolUpload() {
          const val = selectJenis.value.trim().toLowerCase();
          btnUpload.style.display = (val === "") ? "inline-flex" : "none";
        }

        updateTombolUpload();
        selectJenis.addEventListener("input", updateTombolUpload);
        selectJenis.addEventListener("change", updateTombolUpload);
      });

      // Fungsi Logout
      function logout() {
        document.getElementById("logoutModal").style.display = "flex";
      }

      function closeLogoutModal() {
        document.getElementById("logoutModal").style.display = "none";
      }

      function confirmLogout() {
        localStorage.removeItem("currentUser");
        window.location.href = "login.html";
      }
    </script>
  </body>
</html>
